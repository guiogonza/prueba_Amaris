'use strict';

<<<<<<< HEAD
var VERSION = require('../env/data').version;

var validators = {};

// eslint-disable-next-line func-names
['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach(function(type, i) {
=======
import {VERSION} from '../env/data.js';
import AxiosError from '../core/AxiosError.js';

const validators = {};

// eslint-disable-next-line func-names
['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
  validators[type] = function validator(thing) {
    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;
  };
});

<<<<<<< HEAD
var deprecatedWarnings = {};

/**
 * Transitional option validator
 * @param {function|boolean?} validator - set to false if the transitional option has been removed
 * @param {string?} version - deprecated version / removed since version
 * @param {string?} message - some message with additional info
=======
const deprecatedWarnings = {};

/**
 * Transitional option validator
 *
 * @param {function|boolean?} validator - set to false if the transitional option has been removed
 * @param {string?} version - deprecated version / removed since version
 * @param {string?} message - some message with additional info
 *
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
 * @returns {function}
 */
validators.transitional = function transitional(validator, version, message) {
  function formatMessage(opt, desc) {
    return '[Axios v' + VERSION + '] Transitional option \'' + opt + '\'' + desc + (message ? '. ' + message : '');
  }

  // eslint-disable-next-line func-names
<<<<<<< HEAD
  return function(value, opt, opts) {
    if (validator === false) {
      throw new Error(formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')));
=======
  return (value, opt, opts) => {
    if (validator === false) {
      throw new AxiosError(
        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),
        AxiosError.ERR_DEPRECATED
      );
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
    }

    if (version && !deprecatedWarnings[opt]) {
      deprecatedWarnings[opt] = true;
      // eslint-disable-next-line no-console
      console.warn(
        formatMessage(
          opt,
          ' has been deprecated since v' + version + ' and will be removed in the near future'
        )
      );
    }

    return validator ? validator(value, opt, opts) : true;
  };
};

/**
 * Assert object's properties type
<<<<<<< HEAD
 * @param {object} options
 * @param {object} schema
 * @param {boolean?} allowUnknown
=======
 *
 * @param {object} options
 * @param {object} schema
 * @param {boolean?} allowUnknown
 *
 * @returns {object}
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
 */

function assertOptions(options, schema, allowUnknown) {
  if (typeof options !== 'object') {
<<<<<<< HEAD
    throw new TypeError('options must be an object');
  }
  var keys = Object.keys(options);
  var i = keys.length;
  while (i-- > 0) {
    var opt = keys[i];
    var validator = schema[opt];
    if (validator) {
      var value = options[opt];
      var result = value === undefined || validator(value, opt, options);
      if (result !== true) {
        throw new TypeError('option ' + opt + ' must be ' + result);
=======
    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);
  }
  const keys = Object.keys(options);
  let i = keys.length;
  while (i-- > 0) {
    const opt = keys[i];
    const validator = schema[opt];
    if (validator) {
      const value = options[opt];
      const result = value === undefined || validator(value, opt, options);
      if (result !== true) {
        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
      }
      continue;
    }
    if (allowUnknown !== true) {
<<<<<<< HEAD
      throw Error('Unknown option ' + opt);
=======
      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
    }
  }
}

<<<<<<< HEAD
module.exports = {
  assertOptions: assertOptions,
  validators: validators
=======
export default {
  assertOptions,
  validators
>>>>>>> a56f19c81f98fd71e638592bd7853bfbcaab880e
};
