{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Form,Button,Container}from'react-bootstrap';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UnsubscriptionForm=()=>{const[userId,setUserId]=useState('');const[fundId,setFundId]=useState('');const[clients,setClients]=useState([]);const[clientFunds,setClientFunds]=useState([]);useEffect(()=>{const fetchClients=async()=>{try{const response=await axios.get('http://localhost:5000/clients');setClients(response.data);}catch(error){console.error('Error fetching clients:',error);}};fetchClients();},[]);const fetchClientFunds=async clientId=>{try{const response=await axios.get(\"http://localhost:5000/client_funds?client_id=\".concat(clientId));setClientFunds(response.data);}catch(error){console.error('Error fetching client funds:',error);}};const handleClientChange=e=>{const clientId=e.target.value;setUserId(clientId);fetchClientFunds(clientId);};const unsubscribe=async()=>{try{const response=await axios.post('http://localhost:5000/unsubscribe',{client_id:userId,fund_id:fundId});alert(\"Cancelaci\\xF3n exitosa: \".concat(response.data.transaction_id));setClientFunds(clientFunds.filter(fund=>fund.FundID!==fundId));setFundId('');}catch(error){alert(error.response.data.message);}};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Cancelar Suscripci\\xF3n de un Fondo\"}),/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Cliente\"}),/*#__PURE__*/_jsxs(Form.Control,{as:\"select\",value:userId,onChange:handleClientChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccione un cliente\"}),clients.map(client=>/*#__PURE__*/_jsx(\"option\",{value:client.ClienteId,children:client.Name},client.ClienteId))]})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Fondo\"}),/*#__PURE__*/_jsxs(Form.Control,{as:\"select\",value:fundId,onChange:e=>setFundId(e.target.value),disabled:!userId,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccione un fondo\"}),clientFunds.map(fund=>/*#__PURE__*/_jsx(\"option\",{value:fund.FundID,children:fund.FundName},fund.FundID))]})]}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:unsubscribe,disabled:!fundId,children:\"Cancelar Suscripci\\xF3n\"})]})]});};export default UnsubscriptionForm;","map":{"version":3,"names":["React","useState","useEffect","axios","Form","Button","Container","jsx","_jsx","jsxs","_jsxs","UnsubscriptionForm","userId","setUserId","fundId","setFundId","clients","setClients","clientFunds","setClientFunds","fetchClients","response","get","data","error","console","fetchClientFunds","clientId","concat","handleClientChange","e","target","value","unsubscribe","post","client_id","fund_id","alert","transaction_id","filter","fund","FundID","message","children","Group","Label","Control","as","onChange","map","client","ClienteId","Name","disabled","FundName","variant","onClick"],"sources":["C:/Users/guiog/Documents/amaris/fund_app/frontend/src/components/UnsubscriptionForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Form, Button, Container } from 'react-bootstrap';\r\n\r\nconst UnsubscriptionForm = () => {\r\n  const [userId, setUserId] = useState('');\r\n  const [fundId, setFundId] = useState('');\r\n  const [clients, setClients] = useState([]);\r\n  const [clientFunds, setClientFunds] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchClients = async () => {\r\n      try {\r\n        const response = await axios.get('http://localhost:5000/clients');\r\n        setClients(response.data);\r\n      } catch (error) {\r\n        console.error('Error fetching clients:', error);\r\n      }\r\n    };\r\n\r\n    fetchClients();\r\n  }, []);\r\n\r\n  const fetchClientFunds = async (clientId) => {\r\n    try {\r\n      const response = await axios.get(`http://localhost:5000/client_funds?client_id=${clientId}`);\r\n      setClientFunds(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching client funds:', error);\r\n    }\r\n  };\r\n\r\n  const handleClientChange = (e) => {\r\n    const clientId = e.target.value;\r\n    setUserId(clientId);\r\n    fetchClientFunds(clientId);\r\n  };\r\n\r\n  const unsubscribe = async () => {\r\n    try {\r\n      const response = await axios.post('http://localhost:5000/unsubscribe', { client_id: userId, fund_id: fundId });\r\n      alert(`Cancelación exitosa: ${response.data.transaction_id}`);\r\n      setClientFunds(clientFunds.filter(fund => fund.FundID !== fundId));\r\n      setFundId('');\r\n    } catch (error) {\r\n      alert(error.response.data.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <h2>Cancelar Suscripción de un Fondo</h2>\r\n      <Form>\r\n        <Form.Group>\r\n          <Form.Label>Cliente</Form.Label>\r\n          <Form.Control as=\"select\" value={userId} onChange={handleClientChange}>\r\n            <option value=\"\">Seleccione un cliente</option>\r\n            {clients.map((client) => (\r\n              <option key={client.ClienteId} value={client.ClienteId}>{client.Name}</option>\r\n            ))}\r\n          </Form.Control>\r\n        </Form.Group>\r\n        <Form.Group>\r\n          <Form.Label>Fondo</Form.Label>\r\n          <Form.Control as=\"select\" value={fundId} onChange={(e) => setFundId(e.target.value)} disabled={!userId}>\r\n            <option value=\"\">Seleccione un fondo</option>\r\n            {clientFunds.map((fund) => (\r\n              <option key={fund.FundID} value={fund.FundID}>{fund.FundName}</option>\r\n            ))}\r\n          </Form.Control>\r\n        </Form.Group>\r\n        <Button variant=\"danger\" onClick={unsubscribe} disabled={!fundId}>Cancelar Suscripción</Button>\r\n      </Form>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default UnsubscriptionForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}